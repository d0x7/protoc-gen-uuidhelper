# protoc-gen-uuidhelper-go Usage

This README explains how to use the Go helper methods generated by the `protoc-gen-uuidhelper-go` plugin to read and write your `*_uuid` fields and repeated `*_uuids` as `github.com/google/uuid.UUID` in Go.

---

## Generated Methods

For every `bytes foo_uuid = N;` field in your `.proto`, the plugin emits two methods on the generated message struct:

1. **Getter**: `GetFooUUID() uuid.UUID`
2. **Setter**: `SetFooUUID(u uuid.UUID)`

For every `repeated bytes foo_uuids = N;` field in your `.proto`, the plugin emits three methods on the generated message struct:

1. **Getter**: `GetFooUUIDs() []uuid.UUID`
2. **Setter**: `SetFooUUIDs(u []uuid.UUID)`
3. **Adder**: `AddFooUUIDs(u ...uuid.UUID)`

These functions wrap the underlying `[]byte` field accessors and convert to/from `uuid.UUID` automatically.

> [!NOTE]
> All method names for repeated fields are suffixed with "UUIDs" â€” even when operating on single elements, for consistent naming.

### Example `.proto`

```proto
message Player {
  bytes internal_uuid = 1;
  string username     = 2;
  bytes session_uuid  = 3;
  string string_uuid  = 4;
  repeated bytes game_uuids = 5;
}
```

To see an example of what the plugin generates for the above message, check out this [file](../../internal/test/gen/go/test_uuidhelper.pb.go) in the `internal/test/gen/go` directory.

---

## Functions

1. **Setter**

   When creating a new message, you can set the UUID directly:

   ```go
   internal, session := uuid.Must(uuid.NewRandom()), uuid.Must(uuid.NewRandom())
   player := &gen.Player{}
   player.SetInternalUUID(internal)
   player.SetSessionUUID(session)
   ```

   Under the hood, each call converts the `uuid.UUID` to a `[]byte` and then sets the field directly.

2. **Adder**

   For repeated fields, you can add UUIDs using the generated `AddGameUUIDs` method:

   ```go
   first, second := uuid.Must(uuid.NewRandom()), uuid.Must(uuid.NewRandom())
   player := &gen.Player{}
   player.AddGameUUIDs(first)
   player.AddGameUUIDs(second)
   // Or add multiple at once
   player.AddGameUUIDs(first, second)
   ```

3. **Getter**

   After building, read back the UUIDs using the generated `GetInternalUUID` / `GetSessionUUID` methods on the message:

   ```go
   player.GetInternalUUID() // Assert == internal
   player.GetSessionUUID() // Assert == session
   player.GetGameUUIDs() // Assert == [first, second]
   ```

   Again, under the hood, each call accesses the field, converts the `[]byte` to a `uuid.UUID` and returns it.

---

## Quickstart

1. **Build the plugin**

   ```bash
   go build -o protoc-gen-uuidhelper-go ./cmd/protoc-gen-uuidhelper-go
   ```

   It's recommended to add the plugin to your `$PATH` so you can invoke it directly.

   To make this easier, there is a `Taskfile.yaml`, which requires [Task](https://taskfile.dev) to be installed. Then you can do

   ```bash
   task install-go
   ```

   to install the plugin to your `$PATH`, or use the `install` task to install all available plugins.

2. **Invoke `protoc`**

   If you have the plugin installed in your `$PATH`, you can invoke `protoc` directly:

   ```bash
   protoc \
    --uuidhelper-go_out=./gen/go \
    --uuidhelper-go_opt=paths=source_relative \
    your.proto
   ```

   This will generate `*_uuidhelper.pb.go` files in `./gen/go` with the respective methods to set and get UUIDs.

3. **Import and use in your Go code**

   After importing the generated package, you can use the new methods to set and get UUIDs easily, like shown above.
